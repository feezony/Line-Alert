function myFunction() {
  var calenda = CalendarApp.getCalendarById("xxx");
  var token = "xxx"; // Line Token 
  var url = "https://notify-api.line.me/api/notify";
  
  var today = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
  var event = calenda.getEventsForDay(today);
  var msg = "";
  if (event.length === 0) {
    msg = "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°";
  }
  else {
    msg += "üì£üì£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î " + String(event.length) + " ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà\n\n";
    msg += sendMessage(event);
  }
  var jsonData = {
    message: msg
  }
  var options =
  {
    "method": "post",
    "contentType": "application/x-www-form-urlencoded",
    "payload": jsonData,
    "headers": { "Authorization": "Bearer " + token }
  };
  var res = UrlFetchApp.fetch(url, options);
}

function sendMessage(events) {
  var msg = "";
  events.forEach(function (event, index) {
    var title = event.getTitle();
    var start = event.getStartTime().getHours() + ":" + ("0" + event.getStartTime().getMinutes()).slice(-2);
    var end = event.getEndTime().getHours() + ":" + ("0" + event.getEndTime().getMinutes()).slice(-2);
    if (event.isAllDayEvent()) {
      msg += String(index + 1) + ") " + "‡πÄ‡∏ß‡∏•‡∏≤ : " + " ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô" + "\n üî•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : " + title + "\n\n";
      return;
    }
    msg += String(index + 1) + ") " + "‡πÄ‡∏ß‡∏•‡∏≤ : " + start + " - " + end + " ‡∏ô." + "\nüî•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : " + title + "\n\n";
  });
  return msg;
}
 to join this conversation on Git
